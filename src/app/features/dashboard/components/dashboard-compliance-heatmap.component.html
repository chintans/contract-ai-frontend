<div class="compliance-heatmap" role="table" aria-label="Compliance Heatmap">
  @if (categories$ | async; as categories) {
    @if (rules$ | async; as rules) {
      @if (matrix$ | async; as matrix) {
        <div class="heatmap-header" role="row">
          <div class="heatmap-corner"></div>
          @for (rule of rules; track rule) {
            <div class="heatmap-header-cell" role="columnheader">{{ rule }}</div>
          }
        </div>
        @for (row of matrix; track row; let i = $index) {
          <div class="heatmap-row" role="row">
            <div class="heatmap-category" role="rowheader">{{ categories[i] }}</div>
            @for (cell of row; track cell) {
              <div class="heatmap-cell" [ngClass]="cell.status" role="cell" tabindex="0">
                {{ cell.label }}
              </div>
            }
          </div>
        }
      }
    }
  }
</div>